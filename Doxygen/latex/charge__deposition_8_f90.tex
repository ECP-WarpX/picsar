\hypertarget{charge__deposition_8_f90}{}\section{Users/mlobet/\+Google Drive/\+Codes/\+Picsar/picsar\+\_\+mpi\+\_\+com\+\_\+opt/src/charge\+\_\+deposition.F90 File Reference}
\label{charge__deposition_8_f90}\index{Users/mlobet/\+Google Drive/\+Codes/\+Picsar/picsar\+\_\+mpi\+\_\+com\+\_\+opt/src/charge\+\_\+deposition.\+F90@{Users/mlobet/\+Google Drive/\+Codes/\+Picsar/picsar\+\_\+mpi\+\_\+com\+\_\+opt/src/charge\+\_\+deposition.\+F90}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{charge__deposition_8_f90_a35ce588d3192033ca711fc1e13ba35b0}{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid}
\begin{DoxyCompactList}\small\item\em Main subroutine for the charge deposition. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_afa611a1848b404872ce900c3eb0573bc}{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d} (rhog, nxx, nyy, nzz, nxjguard, nyjguard, nzjguard, noxx, noyy, nozz, dxx, dyy, dzz, dtt, c\+\_\+rho\+\_\+old)
\item 
subroutine \hyperlink{charge__deposition_8_f90_ab4d6c7838c470fda0e5bbc3ea68b0917}{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+2d} (rhog, nxx, nyy, nzz, nxjguard, nyjguard, nzjguard, noxx, noyy, nozz, dxx, dyy, dzz, dtt, c\+\_\+rho\+\_\+old)
\item 
subroutine \hyperlink{charge__deposition_8_f90_a7e9f7c059faf5920428cdfec1181a9a8}{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d\+\_\+v2} (func\+\_\+order, rhog, nxx, nyy, nzz, nxjguard, nyjguard, nzjguard, noxx, noyy, nozz, dxx, dyy, dzz, dtt, lvectt, c\+\_\+rho\+\_\+old)
\begin{DoxyCompactList}\small\item\em Deposit rho in each tile in 3D. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_a448f1cab6e843064b45674d43a320022}{depose\+\_\+rho\+\_\+scalar\+\_\+1\+\_\+1\+\_\+1} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                               nxguard, nyguard, nzguard, lvect)
\begin{DoxyCompactList}\small\item\em Order 1 3D scalar charge deposition routine. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_a38e265fb630353694edfd86592922c74}{depose\+\_\+rho\+\_\+scalar\+\_\+2\+\_\+2\+\_\+2} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                                   nxguard, nyguard, nzguard, lvect)
\begin{DoxyCompactList}\small\item\em Order 2 3D scalar charge deposition routine. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_a7bc83de646747d60d464cd7bff59db9f}{depose\+\_\+rho\+\_\+scalar\+\_\+3\+\_\+3\+\_\+3} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                                       nxguard, nyguard, nzguard, lvect)
\begin{DoxyCompactList}\small\item\em Order 3 3D scalar charge deposition routine. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_af27f8c31c24d02ff56d5767f41c425cc}{depose\+\_\+rho\+\_\+vecsh\+\_\+1\+\_\+1\+\_\+1} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)
\item 
subroutine \hyperlink{charge__deposition_8_f90_a570a05e74c2ed2a6fb9f9bf851e68390}{depose\+\_\+rho\+\_\+vecnoy\+\_\+1\+\_\+1\+\_\+1} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)
\item 
subroutine \hyperlink{charge__deposition_8_f90_a9c1d09d89c39bd299a3b894dd419a9c6}{depose\+\_\+rho\+\_\+vechv\+\_\+1\+\_\+1\+\_\+1} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)
\item 
subroutine \hyperlink{charge__deposition_8_f90_a8cd073a8fdaca9986ced5d11280777f6}{depose\+\_\+rho\+\_\+vechvv2\+\_\+1\+\_\+1\+\_\+1} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)
\begin{DoxyCompactList}\small\item\em Order 1 3D vector charge deposition routine. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_a618d3787267c54578f40d084c4d915e3}{depose\+\_\+rho\+\_\+vechvv2\+\_\+2\+\_\+2\+\_\+2} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)
\begin{DoxyCompactList}\small\item\em Order 2 3D vector charge deposition routine. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_a410f5675f18d7fc7da40221984c0f89e}{depose\+\_\+rho\+\_\+vechvv2\+\_\+3\+\_\+3\+\_\+3} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)
\begin{DoxyCompactList}\small\item\em Order 3 3D vector charge deposition routine version 2. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_ac37deeb48a2c970189b6c77f251d2a68}{depose\+\_\+rho\+\_\+vechvv3\+\_\+3\+\_\+3\+\_\+3} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)
\begin{DoxyCompactList}\small\item\em Order 3 3D vector charge deposition routine. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_a55f64905a5f5c387baef1cdddfc060f7}{depose\+\_\+rho\+\_\+vechvv4\+\_\+3\+\_\+3\+\_\+3} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)
\begin{DoxyCompactList}\small\item\em Order 3 3D vector charge deposition routine. \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_a1ba91732b5b34c8c04f7570c8df67c26}{pxr\+\_\+depose\+\_\+rho\+\_\+n} (rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, nox, noy, noz, l\+\_\+particles\+\_\+weight, l4symtry)
\begin{DoxyCompactList}\small\item\em General charge deposition routine (Warning\+: Highly unoptimized routine) \end{DoxyCompactList}\item 
subroutine \hyperlink{charge__deposition_8_f90_a899c2820e69c525f781f0a6c62d3b116}{pxr\+\_\+depose\+\_\+rho\+\_\+n\+\_\+2dxz} (rho, np, xp, yp, zp, w, q, xmin, zmin, dx, dz, nx, nz, nxguard, nzguard, nox, noz, l\+\_\+particles\+\_\+weight, l4symtry, l\+\_\+2drz, type\+\_\+rz\+\_\+depose)
\item 
subroutine \hyperlink{charge__deposition_8_f90_a496878f2bdf85d8dec4a059d6bc40a0f}{pxr\+\_\+depose\+\_\+rhoold\+\_\+n\+\_\+2dxz} (rhoold, np, xp, zp, ux, uy, uz, gaminv, w, q, xmin, zmin, dt, dx, dz, nx, nz, nxguard, nzguard, nox, noz, l\+\_\+particles\+\_\+weight, l4symtry)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+scalar\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+scalar\+\_\+1\+\_\+1\+\_\+1}}
\index{depose\+\_\+rho\+\_\+scalar\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+scalar\+\_\+1\+\_\+1\+\_\+1}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+scalar\+\_\+1\+\_\+1\+\_\+1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                               nxguard, nyguard, nzguard, lvect)}{depose_rho_scalar_1_1_1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                               nxguard, nyguard, nzguard, lvect)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+scalar\+\_\+1\+\_\+1\+\_\+1 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp), intent(in)}]{lvect}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a448f1cab6e843064b45674d43a320022}{}\label{charge__deposition_8_f90_a448f1cab6e843064b45674d43a320022}


Order 1 3D scalar charge deposition routine. 

This subroutine computes the charge density sequentially on grid at order 1. This version does not vectorize on S\+I\+MD architectures \begin{DoxyAuthor}{Author}
Henri Vincenti Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em rho} & charge array \\
\hline
\mbox{\tt in}  & {\em np} & number of particles \\
\hline
\mbox{\tt in}  & {\em xp,yp,zp} & particle position arrays \\
\hline
\mbox{\tt in}  & {\em w} & particle weight arrays \\
\hline
\mbox{\tt in}  & {\em q} & particle species charge \\
\hline
\mbox{\tt in}  & {\em xmin,ymin,zmin} & tile grid minimum position \\
\hline
\mbox{\tt in}  & {\em dx,dy,dz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em nx,ny,nz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxguard,nyguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em lvect} & vector length (useless here, just for interface compatibility) \\
\hline
\end{DoxyParams}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+scalar\+\_\+2\+\_\+2\+\_\+2@{depose\+\_\+rho\+\_\+scalar\+\_\+2\+\_\+2\+\_\+2}}
\index{depose\+\_\+rho\+\_\+scalar\+\_\+2\+\_\+2\+\_\+2@{depose\+\_\+rho\+\_\+scalar\+\_\+2\+\_\+2\+\_\+2}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+scalar\+\_\+2\+\_\+2\+\_\+2(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                                   nxguard, nyguard, nzguard, lvect)}{depose_rho_scalar_2_2_2(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                                   nxguard, nyguard, nzguard, lvect)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+scalar\+\_\+2\+\_\+2\+\_\+2 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp), intent(in)}]{lvect}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a38e265fb630353694edfd86592922c74}{}\label{charge__deposition_8_f90_a38e265fb630353694edfd86592922c74}


Order 2 3D scalar charge deposition routine. 

This subroutine computes the charge density sequentially on grid at order 1. This version does not vectorize on S\+I\+MD architectures \begin{DoxyAuthor}{Author}
Henri Vincenti Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em rho} & charge array \\
\hline
\mbox{\tt in}  & {\em np} & number of particles \\
\hline
\mbox{\tt in}  & {\em xp,yp,zp} & particle position arrays \\
\hline
\mbox{\tt in}  & {\em w} & particle weight arrays \\
\hline
\mbox{\tt in}  & {\em q} & particle species charge \\
\hline
\mbox{\tt in}  & {\em xmin,ymin,zmin} & tile grid minimum position \\
\hline
\mbox{\tt in}  & {\em dx,dy,dz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em nx,ny,nz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxguard,nyguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em lvect} & vector length (useless here, just for interface compatibility) \\
\hline
\end{DoxyParams}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+scalar\+\_\+3\+\_\+3\+\_\+3@{depose\+\_\+rho\+\_\+scalar\+\_\+3\+\_\+3\+\_\+3}}
\index{depose\+\_\+rho\+\_\+scalar\+\_\+3\+\_\+3\+\_\+3@{depose\+\_\+rho\+\_\+scalar\+\_\+3\+\_\+3\+\_\+3}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+scalar\+\_\+3\+\_\+3\+\_\+3(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                                       nxguard, nyguard, nzguard, lvect)}{depose_rho_scalar_3_3_3(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                                       nxguard, nyguard, nzguard, lvect)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+scalar\+\_\+3\+\_\+3\+\_\+3 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp), intent(in)}]{lvect}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a7bc83de646747d60d464cd7bff59db9f}{}\label{charge__deposition_8_f90_a7bc83de646747d60d464cd7bff59db9f}


Order 3 3D scalar charge deposition routine. 

This subroutine computes the charge density sequentially on grid at order 3. This version does not vectorize on S\+I\+MD architectures \begin{DoxyAuthor}{Author}
Henri Vincenti Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em rho} & charge array \\
\hline
\mbox{\tt in}  & {\em np} & number of particles \\
\hline
\mbox{\tt in}  & {\em xp,yp,zp} & particle position arrays \\
\hline
\mbox{\tt in}  & {\em w} & particle weight arrays \\
\hline
\mbox{\tt in}  & {\em q} & particle species charge \\
\hline
\mbox{\tt in}  & {\em xmin,ymin,zmin} & tile grid minimum position \\
\hline
\mbox{\tt in}  & {\em dx,dy,dz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em nx,ny,nz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxguard,nyguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em lvect} & vector length (useless here, just for interface compatibility) \\
\hline
\end{DoxyParams}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+vechv\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+vechv\+\_\+1\+\_\+1\+\_\+1}}
\index{depose\+\_\+rho\+\_\+vechv\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+vechv\+\_\+1\+\_\+1\+\_\+1}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+vechv\+\_\+1\+\_\+1\+\_\+1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)}{depose_rho_vechv_1_1_1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+vechv\+\_\+1\+\_\+1\+\_\+1 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(1\+:(1+nx+2$\ast$nxguard)$\ast$(1+ny+2$\ast$nyguard)$\ast$(1+nz+2$\ast$nzguard)), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a9c1d09d89c39bd299a3b894dd419a9c6}{}\label{charge__deposition_8_f90_a9c1d09d89c39bd299a3b894dd419a9c6}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+vechvv2\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+vechvv2\+\_\+1\+\_\+1\+\_\+1}}
\index{depose\+\_\+rho\+\_\+vechvv2\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+vechvv2\+\_\+1\+\_\+1\+\_\+1}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+vechvv2\+\_\+1\+\_\+1\+\_\+1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)}{depose_rho_vechvv2_1_1_1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+vechvv2\+\_\+1\+\_\+1\+\_\+1 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(1\+:(1+nx+2$\ast$nxguard)$\ast$(1+ny+2$\ast$nyguard)$\ast$(1+nz+2$\ast$nzguard)), intent(inout)}]{rho, }
\item[{integer(idp), intent(in)}]{np, }
\item[{real(num), dimension(np), intent(in)}]{xp, }
\item[{real(num), dimension(np), intent(in)}]{yp, }
\item[{real(num), dimension(np), intent(in)}]{zp, }
\item[{real(num), dimension(np), intent(in)}]{w, }
\item[{real(num), intent(in)}]{q, }
\item[{real(num), intent(in)}]{xmin, }
\item[{real(num), intent(in)}]{ymin, }
\item[{real(num), intent(in)}]{zmin, }
\item[{real(num), intent(in)}]{dx, }
\item[{real(num), intent(in)}]{dy, }
\item[{real(num), intent(in)}]{dz, }
\item[{integer(idp), intent(in)}]{nx, }
\item[{integer(idp), intent(in)}]{ny, }
\item[{integer(idp), intent(in)}]{nz, }
\item[{integer(idp), intent(in)}]{nxguard, }
\item[{integer(idp), intent(in)}]{nyguard, }
\item[{integer(idp), intent(in)}]{nzguard, }
\item[{integer(idp), intent(in)}]{lvect}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a8cd073a8fdaca9986ced5d11280777f6}{}\label{charge__deposition_8_f90_a8cd073a8fdaca9986ced5d11280777f6}


Order 1 3D vector charge deposition routine. 

Computes charge density on grid vectorized at order 1 (H\+V-\/\+S\+C\+H\+E\+ME v2) This routine does vectorize on S\+I\+MD architecture with good performances Speedup$>$2 on A\+VX 256 bits lvect, the vector length was originally at 64 \begin{DoxyAuthor}{Author}
Henri Vincenti Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em rho} & charge array \\
\hline
\mbox{\tt in}  & {\em np} & number of particles \\
\hline
\mbox{\tt in}  & {\em xp,yp,zp} & particle position arrays \\
\hline
\mbox{\tt in}  & {\em w} & particle weight arrays \\
\hline
\mbox{\tt in}  & {\em q} & particle species charge \\
\hline
\mbox{\tt in}  & {\em xmin,ymin,zmin} & tile grid minimum position \\
\hline
\mbox{\tt in}  & {\em dx,dy,dz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em nx,ny,nz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxguard,nyguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em lvect} & vector length \\
\hline
\end{DoxyParams}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+vechvv2\+\_\+2\+\_\+2\+\_\+2@{depose\+\_\+rho\+\_\+vechvv2\+\_\+2\+\_\+2\+\_\+2}}
\index{depose\+\_\+rho\+\_\+vechvv2\+\_\+2\+\_\+2\+\_\+2@{depose\+\_\+rho\+\_\+vechvv2\+\_\+2\+\_\+2\+\_\+2}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+vechvv2\+\_\+2\+\_\+2\+\_\+2(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)}{depose_rho_vechvv2_2_2_2(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+vechvv2\+\_\+2\+\_\+2\+\_\+2 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(1\+:(1+nx+2$\ast$nxguard)$\ast$(1+ny+2$\ast$nyguard)$\ast$(1+nz+2$\ast$nzguard)), intent(inout)}]{rho, }
\item[{integer(idp), intent(in)}]{np, }
\item[{real(num), dimension(np), intent(in)}]{xp, }
\item[{real(num), dimension(np), intent(in)}]{yp, }
\item[{real(num), dimension(np), intent(in)}]{zp, }
\item[{real(num), dimension(np), intent(in)}]{w, }
\item[{real(num), intent(in)}]{q, }
\item[{real(num), intent(in)}]{xmin, }
\item[{real(num), intent(in)}]{ymin, }
\item[{real(num), intent(in)}]{zmin, }
\item[{real(num), intent(in)}]{dx, }
\item[{real(num), intent(in)}]{dy, }
\item[{real(num), intent(in)}]{dz, }
\item[{integer(idp), intent(in)}]{nx, }
\item[{integer(idp), intent(in)}]{ny, }
\item[{integer(idp), intent(in)}]{nz, }
\item[{integer(idp), intent(in)}]{nxguard, }
\item[{integer(idp), intent(in)}]{nyguard, }
\item[{integer(idp), intent(in)}]{nzguard, }
\item[{integer(idp), intent(in)}]{lvect}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a618d3787267c54578f40d084c4d915e3}{}\label{charge__deposition_8_f90_a618d3787267c54578f40d084c4d915e3}


Order 2 3D vector charge deposition routine. 

Computes charge density on grid vectorized at order 2 (H\+V-\/\+S\+C\+H\+E\+ME) This routine does vectorize on S\+I\+MD architecture with good performances Speedup$>$2 on A\+VX 256 bits lvect, the vector length was originally at 16 \begin{DoxyAuthor}{Author}
Henri Vincenti Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em rho} & charge array \\
\hline
\mbox{\tt in}  & {\em np} & number of particles \\
\hline
\mbox{\tt in}  & {\em xp,yp,zp} & particle position arrays \\
\hline
\mbox{\tt in}  & {\em w} & particle weight arrays \\
\hline
\mbox{\tt in}  & {\em q} & particle species charge \\
\hline
\mbox{\tt in}  & {\em xmin,ymin,zmin} & tile grid minimum position \\
\hline
\mbox{\tt in}  & {\em dx,dy,dz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em nx,ny,nz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxguard,nyguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em lvect} & vector length \\
\hline
\end{DoxyParams}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+vechvv2\+\_\+3\+\_\+3\+\_\+3@{depose\+\_\+rho\+\_\+vechvv2\+\_\+3\+\_\+3\+\_\+3}}
\index{depose\+\_\+rho\+\_\+vechvv2\+\_\+3\+\_\+3\+\_\+3@{depose\+\_\+rho\+\_\+vechvv2\+\_\+3\+\_\+3\+\_\+3}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+vechvv2\+\_\+3\+\_\+3\+\_\+3(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)}{depose_rho_vechvv2_3_3_3(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+vechvv2\+\_\+3\+\_\+3\+\_\+3 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(1\+:(1+nx+2$\ast$nxguard)$\ast$(1+ny+2$\ast$nyguard)$\ast$(1+nz+2$\ast$nzguard)), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a410f5675f18d7fc7da40221984c0f89e}{}\label{charge__deposition_8_f90_a410f5675f18d7fc7da40221984c0f89e}


Order 3 3D vector charge deposition routine version 2. 

Computes charge density on grid vectorized (H\+V-\/\+S\+C\+H\+E\+ME) This routine does vectorize on S\+I\+MD architecture with good performances Speedup$>$2 on A\+VX 256 bits \begin{DoxyAuthor}{Author}
Henri Vincenti 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em rho} & charge array \\
\hline
\mbox{\tt in}  & {\em np} & number of particles \\
\hline
\mbox{\tt in}  & {\em xp,yp,zp} & particle position arrays \\
\hline
\mbox{\tt in}  & {\em w} & particle weight arrays \\
\hline
\mbox{\tt in}  & {\em q} & particle species charge \\
\hline
\mbox{\tt in}  & {\em xmin,ymin,zmin} & tile grid minimum position \\
\hline
\mbox{\tt in}  & {\em dx,dy,dz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em nx,ny,nz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxguard,nyguard,nzguard} & number of guard cells \\
\hline
\end{DoxyParams}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+vechvv3\+\_\+3\+\_\+3\+\_\+3@{depose\+\_\+rho\+\_\+vechvv3\+\_\+3\+\_\+3\+\_\+3}}
\index{depose\+\_\+rho\+\_\+vechvv3\+\_\+3\+\_\+3\+\_\+3@{depose\+\_\+rho\+\_\+vechvv3\+\_\+3\+\_\+3\+\_\+3}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+vechvv3\+\_\+3\+\_\+3\+\_\+3(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)}{depose_rho_vechvv3_3_3_3(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+vechvv3\+\_\+3\+\_\+3\+\_\+3 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(1\+:(1+nx+2$\ast$nxguard)$\ast$(1+ny+2$\ast$nyguard)$\ast$(1+nz+2$\ast$nzguard)), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_ac37deeb48a2c970189b6c77f251d2a68}{}\label{charge__deposition_8_f90_ac37deeb48a2c970189b6c77f251d2a68}


Order 3 3D vector charge deposition routine. 

Computes charge density on grid vectorized (H\+V-\/\+S\+C\+H\+E\+ME) This routine does vectorize on S\+I\+MD architecture with good performances Speedup$>$2 on A\+VX 256 bits \begin{DoxyAuthor}{Author}
Henri Vincenti 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em rho} & charge array \\
\hline
\mbox{\tt in}  & {\em np} & number of particles \\
\hline
\mbox{\tt in}  & {\em xp,yp,zp} & particle position arrays \\
\hline
\mbox{\tt in}  & {\em w} & particle weight arrays \\
\hline
\mbox{\tt in}  & {\em q} & particle species charge \\
\hline
\mbox{\tt in}  & {\em xmin,ymin,zmin} & tile grid minimum position \\
\hline
\mbox{\tt in}  & {\em dx,dy,dz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em nx,ny,nz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxguard,nyguard,nzguard} & number of guard cells \\
\hline
\end{DoxyParams}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+vechvv4\+\_\+3\+\_\+3\+\_\+3@{depose\+\_\+rho\+\_\+vechvv4\+\_\+3\+\_\+3\+\_\+3}}
\index{depose\+\_\+rho\+\_\+vechvv4\+\_\+3\+\_\+3\+\_\+3@{depose\+\_\+rho\+\_\+vechvv4\+\_\+3\+\_\+3\+\_\+3}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+vechvv4\+\_\+3\+\_\+3\+\_\+3(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)}{depose_rho_vechvv4_3_3_3(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+vechvv4\+\_\+3\+\_\+3\+\_\+3 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(1\+:(1+nx+2$\ast$nxguard)$\ast$(1+ny+2$\ast$nyguard)$\ast$(1+nz+2$\ast$nzguard)), intent(inout)}]{rho, }
\item[{integer(idp), intent(in)}]{np, }
\item[{real(num), dimension(np), intent(in)}]{xp, }
\item[{real(num), dimension(np), intent(in)}]{yp, }
\item[{real(num), dimension(np), intent(in)}]{zp, }
\item[{real(num), dimension(np), intent(in)}]{w, }
\item[{real(num), intent(in)}]{q, }
\item[{real(num), intent(in)}]{xmin, }
\item[{real(num), intent(in)}]{ymin, }
\item[{real(num), intent(in)}]{zmin, }
\item[{real(num), intent(in)}]{dx, }
\item[{real(num), intent(in)}]{dy, }
\item[{real(num), intent(in)}]{dz, }
\item[{integer(idp), intent(in)}]{nx, }
\item[{integer(idp), intent(in)}]{ny, }
\item[{integer(idp), intent(in)}]{nz, }
\item[{integer(idp), intent(in)}]{nxguard, }
\item[{integer(idp), intent(in)}]{nyguard, }
\item[{integer(idp), intent(in)}]{nzguard, }
\item[{integer(idp), intent(in)}]{lvect}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a55f64905a5f5c387baef1cdddfc060f7}{}\label{charge__deposition_8_f90_a55f64905a5f5c387baef1cdddfc060f7}


Order 3 3D vector charge deposition routine. 

Computes charge density on grid vectorized (H\+V-\/\+S\+C\+H\+E\+ME) This routine does vectorize on S\+I\+MD architecture with good performances Speedup$>$2 on A\+VX 256 bits lvect, the vector length was originally at 16 \begin{DoxyAuthor}{Author}
Henri Vincenti Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em rho} & charge array \\
\hline
\mbox{\tt in}  & {\em np} & number of particles \\
\hline
\mbox{\tt in}  & {\em xp,yp,zp} & particle position arrays \\
\hline
\mbox{\tt in}  & {\em w} & particle weight arrays \\
\hline
\mbox{\tt in}  & {\em q} & particle species charge \\
\hline
\mbox{\tt in}  & {\em xmin,ymin,zmin} & tile grid minimum position \\
\hline
\mbox{\tt in}  & {\em dx,dy,dz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em nx,ny,nz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxguard,nyguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em lvect} & vector length \\
\hline
\end{DoxyParams}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+vecnoy\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+vecnoy\+\_\+1\+\_\+1\+\_\+1}}
\index{depose\+\_\+rho\+\_\+vecnoy\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+vecnoy\+\_\+1\+\_\+1\+\_\+1}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+vecnoy\+\_\+1\+\_\+1\+\_\+1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)}{depose_rho_vecnoy_1_1_1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, lvect)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+vecnoy\+\_\+1\+\_\+1\+\_\+1 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp), intent(in)}]{lvect}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a570a05e74c2ed2a6fb9f9bf851e68390}{}\label{charge__deposition_8_f90_a570a05e74c2ed2a6fb9f9bf851e68390}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!depose\+\_\+rho\+\_\+vecsh\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+vecsh\+\_\+1\+\_\+1\+\_\+1}}
\index{depose\+\_\+rho\+\_\+vecsh\+\_\+1\+\_\+1\+\_\+1@{depose\+\_\+rho\+\_\+vecsh\+\_\+1\+\_\+1\+\_\+1}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{depose\+\_\+rho\+\_\+vecsh\+\_\+1\+\_\+1\+\_\+1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)}{depose_rho_vecsh_1_1_1(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine depose\+\_\+rho\+\_\+vecsh\+\_\+1\+\_\+1\+\_\+1 (
\begin{DoxyParamCaption}
\item[{real(num), dimension(1\+:(1+nx+2$\ast$nxguard)$\ast$(1+ny+2$\ast$nyguard)$\ast$(1+nz+2$\ast$nzguard)), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_af27f8c31c24d02ff56d5767f41c425cc}{}\label{charge__deposition_8_f90_af27f8c31c24d02ff56d5767f41c425cc}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!pxr\+\_\+depose\+\_\+rho\+\_\+n@{pxr\+\_\+depose\+\_\+rho\+\_\+n}}
\index{pxr\+\_\+depose\+\_\+rho\+\_\+n@{pxr\+\_\+depose\+\_\+rho\+\_\+n}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+depose\+\_\+rho\+\_\+n(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, nox, noy, noz, l\+\_\+particles\+\_\+weight, l4symtry)}{pxr_depose_rho_n(rho, np, xp, yp, zp, w, q, xmin, ymin, zmin, dx, dy, dz, nx, ny, nz, nxguard, nyguard, nzguard, nox, noy, noz, l_particles_weight, l4symtry)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+depose\+\_\+rho\+\_\+n (
\begin{DoxyParamCaption}
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp)}]{nox, }
\item[{integer(idp)}]{noy, }
\item[{integer(idp)}]{noz, }
\item[{logical}]{l\+\_\+particles\+\_\+weight, }
\item[{logical}]{l4symtry}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a1ba91732b5b34c8c04f7570c8df67c26}{}\label{charge__deposition_8_f90_a1ba91732b5b34c8c04f7570c8df67c26}


General charge deposition routine (Warning\+: Highly unoptimized routine) 

Computes charge density on grid at arbitrary orders nox, noy and noz \begin{DoxyAuthor}{Author}
Henri Vincenti Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em rho} & charge array \\
\hline
\mbox{\tt in}  & {\em np} & number of particles \\
\hline
\mbox{\tt in}  & {\em xp,yp,zp} & particle position arrays \\
\hline
\mbox{\tt in}  & {\em w} & particle weight arrays \\
\hline
\mbox{\tt in}  & {\em q} & particle species charge \\
\hline
\mbox{\tt in}  & {\em xmin,ymin,zmin} & tile grid minimum position \\
\hline
\mbox{\tt in}  & {\em dx,dy,dz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em nx,ny,nz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxguard,nyguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em nox,noy,noz} & interpolation order \\
\hline
\mbox{\tt in}  & {\em l\+\_\+particle\+\_\+weight} & flag to activate the use of the particle weight \\
\hline
\mbox{\tt in}  & {\em l4symtry} & \\
\hline
\end{DoxyParams}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!pxr\+\_\+depose\+\_\+rho\+\_\+n\+\_\+2dxz@{pxr\+\_\+depose\+\_\+rho\+\_\+n\+\_\+2dxz}}
\index{pxr\+\_\+depose\+\_\+rho\+\_\+n\+\_\+2dxz@{pxr\+\_\+depose\+\_\+rho\+\_\+n\+\_\+2dxz}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+depose\+\_\+rho\+\_\+n\+\_\+2dxz(rho, np, xp, yp, zp, w, q, xmin, zmin, dx, dz, nx, nz, nxguard, nzguard, nox, noz, l\+\_\+particles\+\_\+weight, l4symtry, l\+\_\+2drz, type\+\_\+rz\+\_\+depose)}{pxr_depose_rho_n_2dxz(rho, np, xp, yp, zp, w, q, xmin, zmin, dx, dz, nx, nz, nxguard, nzguard, nox, noz, l_particles_weight, l4symtry, l_2drz, type_rz_depose)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+depose\+\_\+rho\+\_\+n\+\_\+2dxz (
\begin{DoxyParamCaption}
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,0\+:0,-\/nzguard\+:nz+nzguard), intent(inout)}]{rho, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp)}]{nox, }
\item[{integer(idp)}]{noz, }
\item[{logical(idp)}]{l\+\_\+particles\+\_\+weight, }
\item[{logical(idp)}]{l4symtry, }
\item[{logical(idp)}]{l\+\_\+2drz, }
\item[{integer(idp)}]{type\+\_\+rz\+\_\+depose}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a899c2820e69c525f781f0a6c62d3b116}{}\label{charge__deposition_8_f90_a899c2820e69c525f781f0a6c62d3b116}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!pxr\+\_\+depose\+\_\+rhoold\+\_\+n\+\_\+2dxz@{pxr\+\_\+depose\+\_\+rhoold\+\_\+n\+\_\+2dxz}}
\index{pxr\+\_\+depose\+\_\+rhoold\+\_\+n\+\_\+2dxz@{pxr\+\_\+depose\+\_\+rhoold\+\_\+n\+\_\+2dxz}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+depose\+\_\+rhoold\+\_\+n\+\_\+2dxz(rhoold, np, xp, zp, ux, uy, uz, gaminv, w, q, xmin, zmin, dt, dx, dz, nx, nz, nxguard, nzguard, nox, noz, l\+\_\+particles\+\_\+weight, l4symtry)}{pxr_depose_rhoold_n_2dxz(rhoold, np, xp, zp, ux, uy, uz, gaminv, w, q, xmin, zmin, dt, dx, dz, nx, nz, nxguard, nzguard, nox, noz, l_particles_weight, l4symtry)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+depose\+\_\+rhoold\+\_\+n\+\_\+2dxz (
\begin{DoxyParamCaption}
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,0\+:0,-\/nzguard\+:nz+nzguard), intent(inout)}]{rhoold, }
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{ux, }
\item[{real(num), dimension(np)}]{uy, }
\item[{real(num), dimension(np)}]{uz, }
\item[{real(num), dimension(np)}]{gaminv, }
\item[{real(num), dimension(np)}]{w, }
\item[{real(num)}]{q, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dt, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp)}]{nox, }
\item[{integer(idp)}]{noz, }
\item[{logical(idp)}]{l\+\_\+particles\+\_\+weight, }
\item[{logical(idp)}]{l4symtry}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a496878f2bdf85d8dec4a059d6bc40a0f}{}\label{charge__deposition_8_f90_a496878f2bdf85d8dec4a059d6bc40a0f}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!pxrdepose\+\_\+rho\+\_\+on\+\_\+grid@{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid}}
\index{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid@{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid}{pxrdepose_rho_on_grid}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxrdepose\+\_\+rho\+\_\+on\+\_\+grid (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a35ce588d3192033ca711fc1e13ba35b0}{}\label{charge__deposition_8_f90_a35ce588d3192033ca711fc1e13ba35b0}


Main subroutine for the charge deposition. 

this subroutine is called in \hyperlink{main_8_f90}{main.\+F90} and controle all the algorithm. the parameter rhodepo enable to select a specific algorithm. \begin{DoxyAuthor}{Author}
Henri Vincenti Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
last update 09/13/2016 
\end{DoxyDate}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+2d@{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+2d}}
\index{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+2d@{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+2d}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+2d(rhog, nxx, nyy, nzz, nxjguard, nyjguard, nzjguard, noxx, noyy, nozz, dxx, dyy, dzz, dtt, c\+\_\+rho\+\_\+old)}{pxrdepose_rho_on_grid_sub_openmp_2d(rhog, nxx, nyy, nzz, nxjguard, nyjguard, nzjguard, noxx, noyy, nozz, dxx, dyy, dzz, dtt, c_rho_old)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+2d (
\begin{DoxyParamCaption}
\item[{real(num), dimension(-\/nxjguard\+:nxx+nxjguard,-\/nyjguard\+:nyy+nyjguard,-\/nzjguard\+:nzz+nzjguard), intent(inout)}]{rhog, }
\item[{integer(idp), intent(in)}]{nxx, }
\item[{integer(idp), intent(in)}]{nyy, }
\item[{integer(idp), intent(in)}]{nzz, }
\item[{integer(idp), intent(in)}]{nxjguard, }
\item[{integer(idp), intent(in)}]{nyjguard, }
\item[{integer(idp), intent(in)}]{nzjguard, }
\item[{integer(idp), intent(in)}]{noxx, }
\item[{integer(idp), intent(in)}]{noyy, }
\item[{integer(idp), intent(in)}]{nozz, }
\item[{real(num), intent(in)}]{dxx, }
\item[{real(num), intent(in)}]{dyy, }
\item[{real(num), intent(in)}]{dzz, }
\item[{real(num), intent(in)}]{dtt, }
\item[{integer(idp), intent(in)}]{c\+\_\+rho\+\_\+old}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_ab4d6c7838c470fda0e5bbc3ea68b0917}{}\label{charge__deposition_8_f90_ab4d6c7838c470fda0e5bbc3ea68b0917}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d@{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d}}
\index{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d@{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d(rhog, nxx, nyy, nzz, nxjguard, nyjguard, nzjguard, noxx, noyy, nozz, dxx, dyy, dzz, dtt, c\+\_\+rho\+\_\+old)}{pxrdepose_rho_on_grid_sub_openmp_3d(rhog, nxx, nyy, nzz, nxjguard, nyjguard, nzjguard, noxx, noyy, nozz, dxx, dyy, dzz, dtt, c_rho_old)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d (
\begin{DoxyParamCaption}
\item[{real(num), dimension(-\/nxjguard\+:nxx+nxjguard,-\/nyjguard\+:nyy+nyjguard,-\/nzjguard\+:nzz+nzjguard), intent(inout)}]{rhog, }
\item[{integer(idp), intent(in)}]{nxx, }
\item[{integer(idp), intent(in)}]{nyy, }
\item[{integer(idp), intent(in)}]{nzz, }
\item[{integer(idp), intent(in)}]{nxjguard, }
\item[{integer(idp), intent(in)}]{nyjguard, }
\item[{integer(idp), intent(in)}]{nzjguard, }
\item[{integer(idp), intent(in)}]{noxx, }
\item[{integer(idp), intent(in)}]{noyy, }
\item[{integer(idp), intent(in)}]{nozz, }
\item[{real(num), intent(in)}]{dxx, }
\item[{real(num), intent(in)}]{dyy, }
\item[{real(num), intent(in)}]{dzz, }
\item[{real(num), intent(in)}]{dtt, }
\item[{integer(idp), intent(in)}]{c\+\_\+rho\+\_\+old}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_afa611a1848b404872ce900c3eb0573bc}{}\label{charge__deposition_8_f90_afa611a1848b404872ce900c3eb0573bc}
\index{charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}!pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d\+\_\+v2@{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d\+\_\+v2}}
\index{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d\+\_\+v2@{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d\+\_\+v2}!charge\+\_\+deposition.\+F90@{charge\+\_\+deposition.\+F90}}
\subsubsection[{\texorpdfstring{pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d\+\_\+v2(func\+\_\+order, rhog, nxx, nyy, nzz, nxjguard, nyjguard, nzjguard, noxx, noyy, nozz, dxx, dyy, dzz, dtt, lvectt, c\+\_\+rho\+\_\+old)}{pxrdepose_rho_on_grid_sub_openmp_3d_v2(func_order, rhog, nxx, nyy, nzz, nxjguard, nyjguard, nzjguard, noxx, noyy, nozz, dxx, dyy, dzz, dtt, lvectt, c_rho_old)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxrdepose\+\_\+rho\+\_\+on\+\_\+grid\+\_\+sub\+\_\+openmp\+\_\+3d\+\_\+v2 (
\begin{DoxyParamCaption}
\item[{}]{func\+\_\+order, }
\item[{real(num), dimension(-\/nxjguard\+:nxx+nxjguard,-\/nyjguard\+:nyy+nyjguard,-\/nzjguard\+:nzz+nzjguard), intent(inout)}]{rhog, }
\item[{integer(idp), intent(in)}]{nxx, }
\item[{integer(idp), intent(in)}]{nyy, }
\item[{integer(idp), intent(in)}]{nzz, }
\item[{integer(idp), intent(in)}]{nxjguard, }
\item[{integer(idp), intent(in)}]{nyjguard, }
\item[{integer(idp), intent(in)}]{nzjguard, }
\item[{integer(idp), intent(in)}]{noxx, }
\item[{integer(idp), intent(in)}]{noyy, }
\item[{integer(idp), intent(in)}]{nozz, }
\item[{real(num), intent(in)}]{dxx, }
\item[{real(num), intent(in)}]{dyy, }
\item[{real(num), intent(in)}]{dzz, }
\item[{real(num), intent(in)}]{dtt, }
\item[{integer(idp), intent(in)}]{lvectt, }
\item[{integer(idp), intent(in)}]{c\+\_\+rho\+\_\+old}
\end{DoxyParamCaption}
)}\hypertarget{charge__deposition_8_f90_a7e9f7c059faf5920428cdfec1181a9a8}{}\label{charge__deposition_8_f90_a7e9f7c059faf5920428cdfec1181a9a8}


Deposit rho in each tile in 3D. 

This subroutine perform the charge deposition among the tiles using Open\+MP version. It avoids conflict while reducing tile charge in the global charge array.

This version uses arbitrary charge deposition subroutines specified as a parameter\+: func\+\_\+order. This is the reason why this subroutine is called version 2 (v2). \begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em func\+\_\+order} & subroutine for the charge deposition \\
\hline
\mbox{\tt in}  & {\em rhog} & global array for the charge \\
\hline
\mbox{\tt in}  & {\em nxx,nyy,nzz} & number of cells \\
\hline
\mbox{\tt in}  & {\em nxjguard,nyjguard,nzjguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em noxx,noyy,nozz} & interpolation order \\
\hline
\mbox{\tt in}  & {\em dxx,dyy,dzz} & space discretization steps \\
\hline
\mbox{\tt in}  & {\em dtt} & time step \\
\hline
\mbox{\tt in}  & {\em lvectt} & vector length \\
\hline
\mbox{\tt in}  & {\em c\+\_\+rho\+\_\+old} & \\
\hline
\end{DoxyParams}
