\hypertarget{field__gathering__2d_8_f90}{}\section{Users/mlobet/\+Google Drive/\+Codes/\+Picsar/picsar\+\_\+mpi\+\_\+com\+\_\+opt/src/field\+\_\+gathering\+\_\+2d.F90 File Reference}
\label{field__gathering__2d_8_f90}\index{Users/mlobet/\+Google Drive/\+Codes/\+Picsar/picsar\+\_\+mpi\+\_\+com\+\_\+opt/src/field\+\_\+gathering\+\_\+2d.\+F90@{Users/mlobet/\+Google Drive/\+Codes/\+Picsar/picsar\+\_\+mpi\+\_\+com\+\_\+opt/src/field\+\_\+gathering\+\_\+2d.\+F90}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{field__gathering__2d_8_f90_a5c6ac50abbe5706b3f8f33afa68a23a5}{geteb2dxz\+\_\+energy\+\_\+conserving} (np, xp, yp, zp, ex, ey, ez, bx, by, bz,                                                                                                                                                   xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                                                                                                                                                   nxguard, nyguard, nzguard,                                                                                                                                                       nox, noy, noz, exg, eyg, ezg, bxg, byg, bzg,                                                                                                                                                   l4symtry, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v, field\+\_\+gathe\+\_\+algo)
\begin{DoxyCompactList}\small\item\em General subroutines for the 2D cartesian field gathering. \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_ab93a0f4d8c25f1ff4ec81319daea39e2}{pxr\+\_\+gete2dxz\+\_\+n\+\_\+energy\+\_\+conserving} (np, xp, yp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz, nxguard, nzguard,                                                                                                                                                       nox, noz, exg, eyg, ezg, l4symtry, l\+\_\+2drz, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em 2D electric field non-\/optimized gathering routine \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_a5ef609cbdc09685a5b9d25cbd474cefd}{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3} (np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                               nxguard, nzguard, exg, eyg, ezg, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em Scalar subroutine for the cartesian electric field gathering in 2D. \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_a648309863f3cb8275194e515781497a3}{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1} (np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                           nxguard, nzguard, exg, eyg, ezg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em Field gathering cartesian in 2D for the electric field at order 1. \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_a8e30aa1e650fe0c61382d066dde2e3f3}{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2} (np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                           nxguard, nzguard, exg, eyg, ezg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em Field gathering cartesian in 2D for the electric field at order 2. \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_a419fb25a20aa69b7d3e11655fe89eb44}{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3} (np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                           nxguard, nzguard, exg, eyg, ezg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em Field gathering cartesian in 2D for the electric field. \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_aa70004798c24521d5eb8c929aa0d556b}{pxr\+\_\+getb2dxz\+\_\+n\+\_\+energy\+\_\+conserving} (np, xp, yp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz, nxguard, nzguard,                                                                                                                                                       nox, noz, bxg, byg, bzg, l4symtry, l\+\_\+2drz, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em 2D magnetic field gathering routine for arbitrary orders \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_ab95a62b0f83e1ea4e5b626d47ab576ec}{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3} (np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em Scalar Cartesian subroutine for the magnetic field gathering in 2D at order 3. \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_a21c413b3ee03c30a4a0333c74bbf223f}{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1} (np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em Field gathering cartesian in 2D for the magnetic field at order 1. \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_a5390182034479ecd8e7a2050b8124f30}{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2} (np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em Field gathering cartesian in 2D for the magnetic field at order 2. \end{DoxyCompactList}\item 
subroutine \hyperlink{field__gathering__2d_8_f90_a415f9b1053a57ec62f536d8d165af5cf}{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3} (np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)
\begin{DoxyCompactList}\small\item\em Field gathering cartesian in 2D for the magnetic field at order 3. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!geteb2dxz\+\_\+energy\+\_\+conserving@{geteb2dxz\+\_\+energy\+\_\+conserving}}
\index{geteb2dxz\+\_\+energy\+\_\+conserving@{geteb2dxz\+\_\+energy\+\_\+conserving}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{geteb2dxz\+\_\+energy\+\_\+conserving(np, xp, yp, zp, ex, ey, ez, bx, by, bz,                                                                                                                                                   xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                                                                                                                                                   nxguard, nyguard, nzguard,                                                                                                                                                       nox, noy, noz, exg, eyg, ezg, bxg, byg, bzg,                                                                                                                                                   l4symtry, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v, field\+\_\+gathe\+\_\+algo)}{geteb2dxz_energy_conserving(np, xp, yp, zp, ex, ey, ez, bx, by, bz,                                                                                                                                                   xmin, ymin, zmin, dx, dy, dz, nx, ny, nz,                                                                                                                                                   nxguard, nyguard, nzguard,                                                                                                                                                       nox, noy, noz, exg, eyg, ezg, bxg, byg, bzg,                                                                                                                                                   l4symtry, l_lower_order_in_v, field_gathe_algo)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine geteb2dxz\+\_\+energy\+\_\+conserving (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{ex, }
\item[{real(num), dimension(np)}]{ey, }
\item[{real(num), dimension(np)}]{ez, }
\item[{real(num), dimension(np)}]{bx, }
\item[{real(num), dimension(np)}]{by, }
\item[{real(num), dimension(np)}]{bz, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{ymin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dy, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{ny, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nyguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp)}]{nox, }
\item[{integer(idp)}]{noy, }
\item[{integer(idp)}]{noz, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard)}]{exg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard)}]{eyg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard)}]{ezg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard)}]{bxg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard)}]{byg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,-\/nyguard\+:ny+nyguard,-\/nzguard\+:nz+nzguard)}]{bzg, }
\item[{logical(idp), intent(in)}]{l4symtry, }
\item[{logical(idp), intent(in)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v, }
\item[{integer(idp)}]{field\+\_\+gathe\+\_\+algo}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_a5c6ac50abbe5706b3f8f33afa68a23a5}{}\label{field__gathering__2d_8_f90_a5c6ac50abbe5706b3f8f33afa68a23a5}


General subroutines for the 2D cartesian field gathering. 

\begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em ex,ey,ez} & electric field particle arrays \\
\hline
\mbox{\tt in,out}  & {\em bx,by,bz} & magnetic field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em exg,eyg,ezg} & field arrays \\
\hline
\mbox{\tt in}  & {\em bxg,byg,bzg} & field arrays \\
\hline
\mbox{\tt in}  & {\em l4symetry} & \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\mbox{\tt in}  & {\em field\+\_\+gathe\+\_\+algo} & Gathering algorithm \\
\hline
\end{DoxyParams}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3@{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3}}
\index{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3@{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3(np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_getb2dxz_energy_conserving_scalar_3_3(np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3 (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{bx, }
\item[{real(num), dimension(np)}]{by, }
\item[{real(num), dimension(np)}]{bz, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bxg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{byg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bzg, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_ab95a62b0f83e1ea4e5b626d47ab576ec}{}\label{field__gathering__2d_8_f90_ab95a62b0f83e1ea4e5b626d47ab576ec}


Scalar Cartesian subroutine for the magnetic field gathering in 2D at order 3. 

This function is vectorized \begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
12/01/2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em bx,by,bz} & magnetic field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em bxg,byg,bzg} & field arrays \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\end{DoxyParams}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1@{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1}}
\index{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1@{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1(np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_getb2dxz_energy_conserving_vect_1_1(np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, lvect, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1 (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{bx, }
\item[{real(num), dimension(np)}]{by, }
\item[{real(num), dimension(np)}]{bz, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bxg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{byg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bzg, }
\item[{integer(idp)}]{lvect, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_a21c413b3ee03c30a4a0333c74bbf223f}{}\label{field__gathering__2d_8_f90_a21c413b3ee03c30a4a0333c74bbf223f}


Field gathering cartesian in 2D for the magnetic field at order 1. 

This function is vectorized \begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
12/01/2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em bx,by,bz} & magnetic field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em bxg,byg,bzg} & field arrays \\
\hline
\mbox{\tt in}  & {\em lvect} & the vector length of the block of particles \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\end{DoxyParams}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2@{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2}}
\index{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2@{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2(np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_getb2dxz_energy_conserving_vect_2_2(np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, lvect, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2 (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{bx, }
\item[{real(num), dimension(np)}]{by, }
\item[{real(num), dimension(np)}]{bz, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bxg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{byg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bzg, }
\item[{integer(idp)}]{lvect, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_a5390182034479ecd8e7a2050b8124f30}{}\label{field__gathering__2d_8_f90_a5390182034479ecd8e7a2050b8124f30}


Field gathering cartesian in 2D for the magnetic field at order 2. 

This function is vectorized \begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
12/01/2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em bx,by,bz} & magnetic field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em bxg,byg,bzg} & field arrays \\
\hline
\mbox{\tt in}  & {\em lvect} & the vector length of the block of particles \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\end{DoxyParams}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3@{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3}}
\index{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3@{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3(np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_getb2dxz_energy_conserving_vect_3_3(np, xp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz,                                                                       nxguard, nzguard, bxg, byg, bzg, lvect, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+getb2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3 (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{bx, }
\item[{real(num), dimension(np)}]{by, }
\item[{real(num), dimension(np)}]{bz, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bxg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{byg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bzg, }
\item[{integer(idp)}]{lvect, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_a415f9b1053a57ec62f536d8d165af5cf}{}\label{field__gathering__2d_8_f90_a415f9b1053a57ec62f536d8d165af5cf}


Field gathering cartesian in 2D for the magnetic field at order 3. 

This function is vectorized \begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
12/01/2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em bx,by,bz} & magnetic field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em bxg,byg,bzg} & field arrays \\
\hline
\mbox{\tt in}  & {\em lvect} & the vector length of the block of particles \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\end{DoxyParams}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+getb2dxz\+\_\+n\+\_\+energy\+\_\+conserving@{pxr\+\_\+getb2dxz\+\_\+n\+\_\+energy\+\_\+conserving}}
\index{pxr\+\_\+getb2dxz\+\_\+n\+\_\+energy\+\_\+conserving@{pxr\+\_\+getb2dxz\+\_\+n\+\_\+energy\+\_\+conserving}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+getb2dxz\+\_\+n\+\_\+energy\+\_\+conserving(np, xp, yp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz, nxguard, nzguard,                                                                                                                                                       nox, noz, bxg, byg, bzg, l4symtry, l\+\_\+2drz, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_getb2dxz_n_energy_conserving(np, xp, yp, zp, bx, by, bz, xmin, zmin, dx, dz, nx, nz, nxguard, nzguard,                                                                                                                                                       nox, noz, bxg, byg, bzg, l4symtry, l_2drz, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+getb2dxz\+\_\+n\+\_\+energy\+\_\+conserving (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{bx, }
\item[{real(num), dimension(np)}]{by, }
\item[{real(num), dimension(np)}]{bz, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp)}]{nox, }
\item[{integer(idp)}]{noz, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bxg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{byg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{bzg, }
\item[{logical(idp)}]{l4symtry, }
\item[{logical(idp)}]{l\+\_\+2drz, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_aa70004798c24521d5eb8c929aa0d556b}{}\label{field__gathering__2d_8_f90_aa70004798c24521d5eb8c929aa0d556b}


2D magnetic field gathering routine for arbitrary orders 

\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3@{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3}}
\index{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3@{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3(np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                               nxguard, nzguard, exg, eyg, ezg, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_gete2dxz_energy_conserving_scalar_3_3(np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                               nxguard, nzguard, exg, eyg, ezg, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+scalar\+\_\+3\+\_\+3 (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{ex, }
\item[{real(num), dimension(np)}]{ey, }
\item[{real(num), dimension(np)}]{ez, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{exg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{eyg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{ezg, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_a5ef609cbdc09685a5b9d25cbd474cefd}{}\label{field__gathering__2d_8_f90_a5ef609cbdc09685a5b9d25cbd474cefd}


Scalar subroutine for the cartesian electric field gathering in 2D. 

This function is not vectorized \begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
12/01/2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em ex,ey,ez} & electric field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em exg,eyg,ezg} & field arrays \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\end{DoxyParams}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1@{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1}}
\index{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1@{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1(np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                           nxguard, nzguard, exg, eyg, ezg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_gete2dxz_energy_conserving_vect_1_1(np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                           nxguard, nzguard, exg, eyg, ezg, lvect, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+1\+\_\+1 (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{ex, }
\item[{real(num), dimension(np)}]{ey, }
\item[{real(num), dimension(np)}]{ez, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{exg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{eyg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{ezg, }
\item[{integer(idp)}]{lvect, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_a648309863f3cb8275194e515781497a3}{}\label{field__gathering__2d_8_f90_a648309863f3cb8275194e515781497a3}


Field gathering cartesian in 2D for the electric field at order 1. 

This function is vectorized \begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
12/01/2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em ex,ey,ez} & electric field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em exg,eyg,ezg} & field arrays \\
\hline
\mbox{\tt in}  & {\em lvect} & vector size for the block of particles \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\end{DoxyParams}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2@{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2}}
\index{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2@{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2(np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                           nxguard, nzguard, exg, eyg, ezg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_gete2dxz_energy_conserving_vect_2_2(np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                           nxguard, nzguard, exg, eyg, ezg, lvect, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+2\+\_\+2 (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{ex, }
\item[{real(num), dimension(np)}]{ey, }
\item[{real(num), dimension(np)}]{ez, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{exg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{eyg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{ezg, }
\item[{integer(idp)}]{lvect, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_a8e30aa1e650fe0c61382d066dde2e3f3}{}\label{field__gathering__2d_8_f90_a8e30aa1e650fe0c61382d066dde2e3f3}


Field gathering cartesian in 2D for the electric field at order 2. 

This function is vectorized \begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
12/01/2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em ex,ey,ez} & electric field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em exg,eyg,ezg} & field arrays \\
\hline
\mbox{\tt in}  & {\em lvect} & vector size for the block of particles \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\end{DoxyParams}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3@{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3}}
\index{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3@{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3(np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                           nxguard, nzguard, exg, eyg, ezg, lvect, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_gete2dxz_energy_conserving_vect_3_3(np, xp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz,                                                                           nxguard, nzguard, exg, eyg, ezg, lvect, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+gete2dxz\+\_\+energy\+\_\+conserving\+\_\+vect\+\_\+3\+\_\+3 (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{ex, }
\item[{real(num), dimension(np)}]{ey, }
\item[{real(num), dimension(np)}]{ez, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{exg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{eyg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{ezg, }
\item[{integer(idp)}]{lvect, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_a419fb25a20aa69b7d3e11655fe89eb44}{}\label{field__gathering__2d_8_f90_a419fb25a20aa69b7d3e11655fe89eb44}


Field gathering cartesian in 2D for the electric field. 

This function is vectorized \begin{DoxyAuthor}{Author}
Mathieu Lobet 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
12/01/2016 
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em ex,ey,ez} & electric field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em exg,eyg,ezg} & field arrays \\
\hline
\mbox{\tt in}  & {\em lvect} & vector size for the block of particles \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\end{DoxyParams}
\index{field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}!pxr\+\_\+gete2dxz\+\_\+n\+\_\+energy\+\_\+conserving@{pxr\+\_\+gete2dxz\+\_\+n\+\_\+energy\+\_\+conserving}}
\index{pxr\+\_\+gete2dxz\+\_\+n\+\_\+energy\+\_\+conserving@{pxr\+\_\+gete2dxz\+\_\+n\+\_\+energy\+\_\+conserving}!field\+\_\+gathering\+\_\+2d.\+F90@{field\+\_\+gathering\+\_\+2d.\+F90}}
\subsubsection[{\texorpdfstring{pxr\+\_\+gete2dxz\+\_\+n\+\_\+energy\+\_\+conserving(np, xp, yp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz, nxguard, nzguard,                                                                                                                                                       nox, noz, exg, eyg, ezg, l4symtry, l\+\_\+2drz, l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v)}{pxr_gete2dxz_n_energy_conserving(np, xp, yp, zp, ex, ey, ez, xmin, zmin, dx, dz, nx, nz, nxguard, nzguard,                                                                                                                                                       nox, noz, exg, eyg, ezg, l4symtry, l_2drz, l_lower_order_in_v)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine pxr\+\_\+gete2dxz\+\_\+n\+\_\+energy\+\_\+conserving (
\begin{DoxyParamCaption}
\item[{integer(idp)}]{np, }
\item[{real(num), dimension(np)}]{xp, }
\item[{real(num), dimension(np)}]{yp, }
\item[{real(num), dimension(np)}]{zp, }
\item[{real(num), dimension(np)}]{ex, }
\item[{real(num), dimension(np)}]{ey, }
\item[{real(num), dimension(np)}]{ez, }
\item[{real(num)}]{xmin, }
\item[{real(num)}]{zmin, }
\item[{real(num)}]{dx, }
\item[{real(num)}]{dz, }
\item[{integer(idp)}]{nx, }
\item[{integer(idp)}]{nz, }
\item[{integer(idp)}]{nxguard, }
\item[{integer(idp)}]{nzguard, }
\item[{integer(idp)}]{nox, }
\item[{integer(idp)}]{noz, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{exg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{eyg, }
\item[{real(num), dimension(-\/nxguard\+:nx+nxguard,1,-\/nzguard\+:nz+nzguard)}]{ezg, }
\item[{logical(idp)}]{l4symtry, }
\item[{logical(idp)}]{l\+\_\+2drz, }
\item[{logical(idp)}]{l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v}
\end{DoxyParamCaption}
)}\hypertarget{field__gathering__2d_8_f90_ab93a0f4d8c25f1ff4ec81319daea39e2}{}\label{field__gathering__2d_8_f90_ab93a0f4d8c25f1ff4ec81319daea39e2}


2D electric field non-\/optimized gathering routine 

This function is similar to what is implemented in W\+A\+RP 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Number of particles \\
\hline
\mbox{\tt in}  & {\em xp,zp} & particle position arrays \\
\hline
\mbox{\tt in,out}  & {\em ex,ey,ez} & electric field particle arrays \\
\hline
\mbox{\tt in}  & {\em xmin,zmin} & tile boundaries \\
\hline
\mbox{\tt in}  & {\em dx,dz} & space steps \\
\hline
\mbox{\tt in}  & {\em nx,nz} & space discretization \\
\hline
\mbox{\tt in}  & {\em nxguard,nzguard} & number of guard cells \\
\hline
\mbox{\tt in}  & {\em exg,eyg,ezg} & field arrays \\
\hline
\mbox{\tt in}  & {\em lvect} & vector size for the block of particles \\
\hline
\mbox{\tt in}  & {\em l\+\_\+lower\+\_\+order\+\_\+in\+\_\+v} & flag to determine if we interpolate at a lower order \\
\hline
\end{DoxyParams}
